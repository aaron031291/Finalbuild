// Take memory snapshots
const fs = require('fs');
const profiler = require('v8-profiler-next');

function takeHeapSnapshot() {
  const snapshot = profiler.takeSnapshot();
  
  // Save snapshot to file
  snapshot.export((error, result) => {
    fs.writeFileSync(`heap-snapshot-${Date.now()}.heapsnapshot`, result);
    snapshot.delete();
    console.log('Heap snapshot saved');
  });
}

// Take snapshot every 5 minutes
setInterval(takeHeapSnapshot, 5 * 60 * 1000);